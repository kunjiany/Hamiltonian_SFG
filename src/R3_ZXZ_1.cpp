#include "R3_ZXZ_1.hpp"
#include <cstring>

void R3_ZXZ_1(double Psi, double Theta, double R[27][27])
{
    // Wipe R
    std::memset(R, 0, sizeof(double) * 27 * 27);

    // Precompute all t-variables exactly like MATLAB
    double t2 = sin(Psi);
    double t3 = sin(Theta);
    double t4 = t2*t2;
    double t5 = t3*t3;
    double t6 = cos(Psi);
    double t7 = cos(Theta);
    double t14 = Psi * 0.5;
    double t8 = sin(t14);
    double t9 = t7*t7;
    double t10 = t9 - 1.0;
    double t11 = t6*t6;
    double t12 = t11 - 1.0;
    double t13 = t2*t6*t7*t10*0.5;
    double t15 = t8*t8;
    double t16 = t15*2.0;
    double t17 = t16 - 1.0;
    double t18 = t3*t4*t5*t17*0.5;
    double t19 = t4 - 1.0;
    double t20 = t2*t3*t5*t19*0.5;
    double t21 = t5 - 1.0;
    double t22 = 1.0/M_PI;
    double t23 = t2*t3*t21*0.5;
    double t24 = t7*t10*t11*0.5;
    double t25 = t3*t6*t7*0.5;
    double t26 = t2*t3*t7*0.5;
    double t27 = t9*0.5;
    double t28 = t4*t5*0.5;
    double t29 = Psi*2.0;
    double t30 = sin(t29);
    double t31 = t5*t30*0.25;
    double t32 = Theta*2.0;
    double t33 = cos(t32);
    double t34 = t33*0.5;
    double t35 = t34 - 0.5;
    double t36 = t30*t35*0.25;
    double t37 = t4*t5;
    double t38 = t37 - 1.0;
    double t39 = t28 - 0.5;
    double t40 = t10*t12*0.5;
    double t41 = t40 - 0.5;
    double t42 = M_PI*t2*t3*t21;
    double t53 = M_PI*t2*t3*t4*t5;
    double t43 = t42 - t53;
    double t44 = M_PI*t21;
    double t54 = M_PI*t4*t5;
    double t45 = t44 - t54;
    double t46 = M_PI*t7*t9;
    double t47 = M_PI*t7*t10*t12;
    double t48 = t46 + t47;
    double t49 = t22*t48*0.5;
    double t50 = t2*t3*t5*0.5;
    double t51 = t3*t5*t6*0.5;
    double t52 = t5*t11*0.5;
    double t55 = t3*t4*t5*t6;
    double t56 = t7*t10*t12;
    double t57 = t3*t17*t21;
    // --- You will add the missing intermediate t12..t57 ---
    // use your MATLAB definitions exactly

    // ------------------------------------------------------
    // 1) Flat vector V[729] (row-major)
    // ------------------------------------------------------
    double V[27*27];

    // ------------------------------------------------------
    // 2) MANUALLY paste your 729 MATLAB entries here
    //
    // MATLAB is column-major so reshape([ ... ], [27 27])
    // corresponds in C++ row-major to:
    // V[row*27 + col] = (MATLAB linear index)
    //
    // I give the structure. You fill in the 729 actual entries.
    // ------------------------------------------------------

    // Example (you must replace *** manually ***):
    // --- V[0..99] ---------------------------------------------

    V[0]  = 0.0;
    V[1]  = 0.0;
    V[2]  = t2*t3*t38*(-0.5);
    V[3]  = 0.0;
    V[4]  = 0.0;
    V[5]  = 0.0;
    V[6]  = t2*t3*t38*(-0.5);
    V[7]  = 0.0;
    V[8]  = 0.0;
    V[9]  = 0.0;
    V[10] = 0.0;
    V[11] = 0.0;
    V[12] = 0.0;
    V[13] = 0.0;
    V[14] = t2*t3*t38*(-0.5);
    V[15] = 0.0;
    V[16] = t2*t3*t38*(-0.5);
    V[17] = 0.0;
    V[18] = t2*t3*t38*(-0.5);
    V[19] = 0.0;
    V[20] = 0.0;
    V[21] = 0.0;
    V[22] = t2*t3*t38*(-0.5);
    V[23] = 0.0;
    V[24] = 0.0;
    V[25] = 0.0;

    V[26] = t2*t3*t4*t5;
    V[27] = 0.0;
    V[28] = 0.0;
    V[29] = -(t3*t6*t39);
    V[30] = 0.0;
    V[31] = 0.0;
    V[32] = 0.0;
    V[33] = t18;
    V[34] = t26;
    V[35] = 0.0;
    V[36] = 0.0;
    V[37] = 0.0;
    V[38] = 0.0;
    V[39] = 0.0;
    V[40] = 0.0;
    V[41] = -(t3*t6*t39);
    V[42] = -t26;
    V[43] = t18;

    V[44] = 0.0;
    V[45] = t18;
    V[46] = t26;
    V[47] = 0.0;
    V[48] = -t26;
    V[49] = t18;
    V[50] = 0.0;
    V[51] = 0.0;
    V[52] = 0.0;

    V[53] = t55;
    V[54] = 0.0;
    V[55] = 0.0;
    V[56] = -(t7*t41);
    V[57] = 0.0;
    V[58] = 0.0;
    V[59] = 0.0;

    V[60] = t7*t10*t12*(-0.5);
    V[61] = t36;
    V[62] = 0.0;
    V[63] = 0.0;
    V[64] = 0.0;
    V[65] = 0.0;
    V[66] = 0.0;
    V[67] = 0.0;

    V[68] = -(t7*t41);
    V[69] = t31;
    V[70] = t7*t10*t12*(-0.5);

    V[71] = 0.0;
    V[72] = t7*t10*t12*(-0.5);
    V[73] = t36;
    V[74] = 0.0;
    V[75] = t31;
    V[76] = t7*t10*t12*(-0.5);
    V[77] = 0.0;
    V[78] = 0.0;
    V[79] = 0.0;

    V[80] = t56;
    V[81] = 0.0;
    V[82] = 0.0;
    V[83] = t18;
    V[84] = 0.0;
    V[85] = 0.0;
    V[86] = t26;
    V[87] = -(t3*t6*t39);
    V[88] = 0.0;
    V[89] = 0.0;

    V[90] = 0.0;
    V[91] = 0.0;
    V[92] = -t26;
    V[93] = 0.0;
    V[94] = 0.0;
    V[95] = t18;
    V[96] = 0.0;
    V[97] = -(t3*t6*t39);
    V[98] = 0.0;
    V[99] = t18;

    V[100] = -t26;
    V[101] = 0.0;
    V[102] = t26;
    V[103] = t18;
    V[104] = 0.0;
    V[105] = 0.0;
    V[106] = 0.0;

    V[107] = t55;
    V[108] = 0.0;
    V[109] = 0.0;
    V[110] = t20;
    V[111] = 0.0;
    V[112] = 0.0;
    V[113] = t25;

    V[114] = t20;
    V[115] = t25;
    V[116] = 0.0;
    V[117] = 0.0;
    V[118] = 0.0;

    V[119] = -t25;
    V[120] = 0.0;
    V[121] = 0.0;
    V[122] = t20;
    V[123] = -t25;
    V[124] = t20;

    V[125] = 0.0;

    V[126] = t22*t43*(-0.5);
    V[127] = 0.0;
    V[128] = 0.0;
    V[129] = 0.0;

    V[130] = t22*t43*(-0.5);
    V[131] = 0.0;
    V[132] = 0.0;
    V[133] = 0.0;

    V[134] = -(t2*t3*t5*t19);
    V[135] = 0.0;
    V[136] = 0.0;
    V[137] = t13;
    V[138] = 0.0;
    V[139] = 0.0;

    V[140] = t27;
    V[141] = t13;
    V[142] = -t52;
    V[143] = 0.0;
    V[144] = 0.0;
    V[145] = 0.0;

    V[146] = -t27;
    V[147] = 0.0;
    V[148] = 0.0;
    V[149] = t13;
    V[150] = t52;
    V[151] = t13;

    V[152] = 0.0;

    V[153] = t13;
    V[154] = t28;
    V[155] = 0.0;
    V[156] = -t28;
    V[157] = t13;
    V[158] = 0.0;

    V[159] = 0.0;
    V[160] = 0.0;
    V[161] = 0.0;

    V[162] = -(t2*t6*t7*t10);
    V[163] = 0.0;
    V[164] = 0.0;

    V[165] = t7*t10*t12*(-0.5);
    V[166] = 0.0;
    V[167] = 0.0;
    V[168] = t36;

    V[169] = -t7*t41;
    V[170] = 0.0;
    V[171] = 0.0;
    V[172] = 0.0;

    V[173] = 0.0;
    V[174] = t31;
    V[175] = 0.0;
    V[176] = 0.0;

    V[177] = t7*t10*t12*(-0.5);
    V[178] = 0.0;
    V[179] = -t7*t41;
    V[180] = 0.0;

    V[181] = t7*t10*t12*(-0.5);
    V[182] = t31;
    V[183] = 0.0;

    V[184] = t36;
    V[185] = t7*t10*t12*(-0.5);
    V[186] = 0.0;

    V[187] = 0.0;
    V[188] = 0.0;
    V[189] = 0.0;

    V[190] = t56;
    V[191] = 0.0;
    V[192] = 0.0;

    V[193] = t13;
    V[194] = 0.0;
    V[195] = 0.0;

    V[196] = t5*t11*(-0.5);
    V[197] = t13;
    V[198] = t27;
    V[199] = 0.0;

    V[200] = 0.0;
    V[201] = 0.0;
    V[202] = t52;
    V[203] = 0.0;
    V[204] = 0.0;
    V[205] = t13;
    V[206] = -t27;
    V[207] = t13;
    V[208] = 0.0;

    V[209] = t13;
    V[210] = -t28;
    V[211] = 0.0;
    V[212] = t28;
    V[213] = t13;
    V[214] = 0.0;

    V[215] = 0.0;
    V[216] = 0.0;
    V[217] = 0.0;

    V[218] = -(t2*t6*t7*t10);
    V[219] = 0.0;
    V[220] = 0.0;

    V[221] = t23;
    V[222] = 0.0;
    V[223] = 0.0;

    V[224] = -t25;
    V[225] = t23;
    V[226] = -t25;
    V[227] = 0.0;

    V[228] = 0.0;
    V[229] = 0.0;

    V[230] = t25;
    V[231] = 0.0;
    V[232] = 0.0;

    V[233] = t23;
    V[234] = t25;
    V[235] = t23;

    V[236] = 0.0;

    V[237] = t50;
    V[238] = 0.0;
    V[239] = 0.0;
    V[240] = 0.0;

    V[241] = t50;
    V[242] = 0.0;
    V[243] = 0.0;
    V[244] = 0.0;

    V[245] = -(t2*t3*t21);
    V[246] = 0.0;
    V[247] = 0.0;

    V[248] = t18;
    V[249] = 0.0;
    V[250] = 0.0;

    V[251] = -t26;
    V[252] = t18;
    V[253] = -t26;
    V[254] = 0.0;

    V[255] = 0.0;
    V[256] = 0.0;

    V[257] = t26;
    V[258] = 0.0;
    V[259] = 0.0;

    V[260] = t18;
    V[261] = t26;
    V[262] = t18;

    V[263] = 0.0;

    V[264] = -t3*t6*t39;
    V[265] = 0.0;
    V[266] = 0.0;
    V[267] = 0.0;

    V[268] = -t3*t6*t39;
    V[269] = 0.0;
    V[270] = 0.0;
    V[271] = 0.0;

    V[272] = t55;
    V[273] = 0.0;
    V[274] = 0.0;

    V[275] = t20;
    V[276] = 0.0;
    V[277] = 0.0;

    V[278] = -t25;
    V[279] = t22*t43*(-0.5);
    V[280] = 0.0;

    V[281] = 0.0;
    V[282] = 0.0;
    V[283] = t25;
    V[284] = 0.0;

    V[285] = 0.0;
    V[286] = t20;
    V[287] = 0.0;
    V[288] = t22*t43*(-0.5);

    V[289] = 0.0;

    V[290] = t20;
    V[291] = t25;
    V[292] = 0.0;
    V[293] = -t25;
    V[294] = t20;

    V[295] = 0.0;
    V[296] = 0.0;
    V[297] = 0.0;

    V[298] = -(t2*t3*t5*t19);
    V[299] = 0.0;

    V[300] = 0.0;
    V[301] = t13;
    V[302] = 0.0;
    V[303] = 0.0;
    V[304] = -t27;
    V[305] = t13;
    V[306] = t28;
    V[307] = 0.0;
    V[308] = 0.0;

    V[309] = 0.0;
    V[310] = t27;
    V[311] = 0.0;
    V[312] = 0.0;
    V[313] = t13;
    V[314] = -t28;

    V[315] = t13;
    V[316] = 0.0;
    V[317] = t13;

    V[318] = 0.0;
    V[319] = t13;
    V[320] = -t52;
    V[321] = 0.0;
    V[322] = t52;
    V[323] = t13;

    V[324] = 0.0;
    V[325] = 0.0;
    V[326] = 0.0;

    V[327] = -(t2*t6*t7*t10);
    V[328] = 0.0;
    V[329] = 0.0;

    V[330] = t22*t43*(-0.5);
    V[331] = 0.0;
    V[332] = 0.0;

    V[333] = 0.0;
    V[334] = t20;
    V[335] = -t25;

    V[336] = 0.0;
    V[337] = 0.0;
    V[338] = 0.0;

    V[339] = 0.0;
    V[340] = 0.0;
    V[341] = 0.0;

    V[342] = t22*t43*(-0.5);
    V[343] = t25;
    V[344] = t20;

    V[345] = 0.0;
    V[346] = t20;
    V[347] = -t25;

    V[348] = 0.0;
    V[349] = t25;
    V[350] = t20;

    V[351] = 0.0;
    V[352] = 0.0;
    V[353] = 0.0;

    V[354] = -(t2*t3*t5*t19);
    V[355] = 0.0;
    V[356] = 0.0;

    V[357] = t3*t6*t22*t45*(-0.5);
    V[358] = 0.0;
    V[359] = 0.0;

    V[360] = 0.0;
    V[361] = t3*t6*t22*t45*(-0.5);
    V[362] = 0.0;

    V[363] = 0.0;
    V[364] = 0.0;
    V[365] = 0.0;

    V[366] = 0.0;
    V[367] = t3*t6*t22*t45*(-0.5);
    V[368] = 0.0;

    V[369] = t3*t6*t22*t45*(-0.5);
    V[370] = 0.0;
    V[371] = t3*t6*t22*t45*(-0.5);

    V[372] = 0.0;
    V[373] = 0.0;
    V[374] = 0.0;

    V[375] = t3*t6*t22*t45*(-0.5);
    V[376] = 0.0;
    V[377] = 0.0;

    V[378] = 0.0;
    V[379] = t3*t5*t6*t11;
    V[380] = 0.0;

    V[381] = 0.0;
    V[382] = t49;
    V[383] = 0.0;

    V[384] = 0.0;
    V[385] = 0.0;
    V[386] = 0.0;

    V[387] = t24;
    V[388] = t31;
    V[389] = 0.0;

    V[390] = 0.0;
    V[391] = 0.0;
    V[392] = 0.0;

    V[393] = 0.0;
    V[394] = 0.0;
    V[395] = 0.0;

    V[396] = t49;
    V[397] = t36;
    V[398] = t24;
    V[399] = 0.0;

    V[400] = t24;
    V[401] = t31;
    V[402] = 0.0;
    V[403] = t36;
    V[404] = t24;
    V[405] = 0.0;

    V[406] = 0.0;
    V[407] = 0.0;
    V[408] = 0.0;

    V[409] = -(t7*t10*t11);
    V[410] = 0.0;
    V[411] = 0.0;

    V[412] = t13;
    V[413] = 0.0;
    V[414] = 0.0;

    V[415] = t28;
    V[416] = t13;
    V[417] = -t27;

    V[418] = 0.0;
    V[419] = 0.0;
    V[420] = 0.0;

    V[421] = t28;
    V[422] = 0.0;
    V[423] = 0.0;

    V[424] = t13;
    V[425] = t27;
    V[426] = t13;

    V[427] = 0.0;
    V[428] = t13;
    V[429] = t52;

    V[430] = 0.0;
    V[431] = -t52;
    V[432] = t13;

    V[433] = 0.0;
    V[434] = 0.0;
    V[435] = 0.0;

    V[436] = -(t2*t6*t7*t10);
    V[437] = 0.0;
    V[438] = 0.0;

    V[439] = t24;
    V[440] = 0.0;
    V[441] = 0.0;

    V[442] = t31;
    V[443] = t49;
    V[444] = 0.0;

    V[445] = 0.0;
    V[446] = 0.0;
    V[447] = 0.0;

    V[448] = t36;
    V[449] = 0.0;
    V[450] = 0.0;

    V[451] = t24;
    V[452] = 0.0;
    V[453] = t49;

    V[454] = 0.0;
    V[455] = t24;
    V[456] = t36;

    V[457] = 0.0;
    V[458] = t31;
    V[459] = t24;

    V[460] = 0.0;
    V[461] = 0.0;
    V[462] = 0.0;

    V[463] = -(t7*t10*t11);
    V[464] = 0.0;
    V[465] = 0.0;

    V[466] = t3*t17*t21*(-0.5);
    V[467] = 0.0;
    V[468] = 0.0;

    V[469] = t26;
    V[470] = t3*t17*t21*(-0.5);
    V[471] = t26;

    V[472] = 0.0;
    V[473] = 0.0;
    V[474] = 0.0;

    V[475] = -t26;
    V[476] = 0.0;
    V[477] = 0.0;

    V[478] = t3*t17*t21*(-0.5);
    V[479] = -t26;
    V[480] = t3*t17*t21*(-0.5);

    V[481] = 0.0;
    V[482] = t51;
    V[483] = 0.0;

    V[484] = 0.0;
    V[485] = t51;
    V[486] = 0.0;

    V[487] = 0.0;
    V[488] = 0.0;
    V[489] = 0.0;

    V[490] = t57;
    V[491] = 0.0;
    V[492] = 0.0;

    V[493] = t7*t10*t12*(-0.5);
    V[494] = 0.0;
    V[495] = 0.0;

    V[496] = t31;
    V[497] = t7*t10*t12*(-0.5);
    V[498] = t31;
    V[499] = 0.0;

    V[500] = 0.0;
    V[501] = 0.0;
    V[502] = 0.0;

    V[503] = t36;
    V[504] = 0.0;
    V[505] = 0.0;

    V[506] = t7*t10*t12*(-0.5);
    V[507] = t36;
    V[508] = t7*t10*t12*(-0.5);

    V[509] = 0.0;

    V[510] = -t7*t41;
    V[511] = 0.0;
    V[512] = 0.0;

    V[513] = 0.0;
    V[514] = -t7*t41;
    V[515] = 0.0;

    V[516] = 0.0;
    V[517] = 0.0;
    V[518] = 0.0;

    V[519] = t56;
    V[520] = 0.0;
    V[521] = 0.0;

    V[522] = t13;
    V[523] = 0.0;
    V[524] = 0.0;

    V[525] = t52;
    V[526] = t13;
    V[527] = -t28;

    V[528] = 0.0;
    V[529] = 0.0;
    V[530] = 0.0;

    V[531] = -t52;
    V[532] = 0.0;
    V[533] = 0.0;

    V[534] = t13;
    V[535] = t28;
    V[536] = t13;

    V[537] = 0.0;
    V[538] = t13;
    V[539] = t27;

    V[540] = 0.0;
    V[541] = -t27;
    V[542] = t13;

    V[543] = 0.0;
    V[544] = 0.0;
    V[545] = 0.0;

    V[546] = -(t2*t6*t7*t10);
    V[547] = 0.0;
    V[548] = 0.0;

    V[549] = t23;
    V[550] = 0.0;
    V[551] = 0.0;

    V[552] = t25;
    V[553] = t50;
    V[554] = 0.0;

    V[555] = 0.0;
    V[556] = 0.0;
    V[557] = 0.0;

    V[558] = -t25;
    V[559] = 0.0;
    V[560] = 0.0;

    V[561] = t23;
    V[562] = 0.0;
    V[563] = t50;

    V[564] = 0.0;
    V[565] = t23;
    V[566] = -t25;

    V[567] = 0.0;
    V[568] = t25;
    V[569] = t23;

    V[570] = 0.0;
    V[571] = 0.0;
    V[572] = 0.0;

    V[573] = -(t2*t3*t21);
    V[574] = 0.0;
    V[575] = 0.0;

    V[576] = t13;
    V[577] = 0.0;
    V[578] = 0.0;

    V[579] = -t28;
    V[580] = t13;
    V[581] = t52;

    V[582] = 0.0;
    V[583] = 0.0;
    V[584] = 0.0;

    V[585] = t28;
    V[586] = 0.0;
    V[587] = 0.0;

    V[588] = t13;
    V[589] = -t52;
    V[590] = t13;

    V[591] = 0.0;
    V[592] = t13;
    V[593] = -t27;

    V[594] = 0.0;
    V[595] = t27;
    V[596] = t13;

    V[597] = 0.0;
    V[598] = 0.0;
    V[599] = 0.0;

    V[600] = -(t2*t6*t7*t10);
    V[601] = 0.0;
    V[602] = 0.0;

    V[603] = t24;
    V[604] = 0.0;
    V[605] = 0.0;

    V[606] = t36;
    V[607] = t24;
    V[608] = t36;

    V[609] = 0.0;
    V[610] = 0.0;
    V[611] = 0.0;

    V[612] = t31;
    V[613] = 0.0;
    V[614] = 0.0;

    V[615] = t24;
    V[616] = t31;
    V[617] = t24;

    V[618] = 0.0;
    V[619] = t49;
    V[620] = 0.0;

    V[621] = 0.0;
    V[622] = 0.0;
    V[623] = 0.0;

    V[624] = t49;
    V[625] = 0.0;
    V[626] = 0.0;

    V[627] = 0.0;
    V[628] = -(t7*t10*t11);
    V[629] = 0.0;

    V[630] = 0.0;
    V[631] = t13;
    V[632] = 0.0;

    V[633] = 0.0;
    V[634] = t28;
    V[635] = t13;

    V[636] = t27;
    V[637] = 0.0;
    V[638] = 0.0;

    V[639] = 0.0;
    V[640] = -t28;
    V[641] = 0.0;

    V[642] = 0.0;
    V[643] = t13;
    V[644] = t27;

    V[645] = t13;
    V[646] = 0.0;
    V[647] = t13;

    V[648] = t52;
    V[649] = 0.0;
    V[650] = -t52;

    V[651] = 0.0;
    V[652] = 0.0;
    V[653] = 0.0;

    V[654] = -(t2*t6*t7*t10);
    V[655] = 0.0;
    V[656] = 0.0;

    V[657] = t24;
    V[658] = 0.0;
    V[659] = 0.0;

    V[660] = t31;
    V[661] = t49;
    V[662] = 0.0;

    V[663] = 0.0;
    V[664] = 0.0;
    V[665] = 0.0;

    V[666] = t36;
    V[667] = 0.0;
    V[668] = 0.0;

    V[669] = t24;
    V[670] = 0.0;
    V[671] = t49;

    V[672] = 0.0;
    V[673] = t24;
    V[674] = t36;

    V[675] = 0.0;
    V[676] = t31;
    V[677] = t24;

    V[678] = 0.0;
    V[679] = 0.0;
    V[680] = 0.0;

    V[681] = -(t7*t10*t11);
    V[682] = 0.0;
    V[683] = 0.0;

    V[684] = t3*t17*t21*(-0.5);
    V[685] = 0.0;
    V[686] = 0.0;

    V[687] = -t26;
    V[688] = t51;
    V[689] = 0.0;

    V[690] = 0.0;
    V[691] = 0.0;
    V[692] = 0.0;

    V[693] = t26;
    V[694] = 0.0;
    V[695] = 0.0;

    V[696] = t3*t17*t21*(-0.5);
    V[697] = 0.0;
    V[698] = t51;

    V[699] = 0.0;
    V[700] = t3*t17*t21*(-0.5);
    V[701] = t26;

    V[702] = 0.0;
    V[703] = -t26;
    V[704] = t3*t17*t21*(-0.5);

    V[705] = 0.0;
    V[706] = 0.0;
    V[707] = 0.0;

    V[708] = t57;
    V[709] = 0.0;
    V[710] = 0.0;

    V[711] = t50;
    V[712] = 0.0;
    V[713] = 0.0;

    V[714] = 0.0;
    V[715] = t23;
    V[716] = t25;

    V[717] = 0.0;
    V[718] = 0.0;
    V[719] = 0.0;

    V[720] = t50;
    V[721] = -t25;
    V[722] = t23;

    V[723] = 0.0;
    V[724] = t23;
    V[725] = t25;

    V[726] = 0.0;
    V[727] = -t25;
    V[728] = t23;


    // Correct column-major mapping of V â†’ R[row][col]
    for (int col = 0; col < 27; ++col) {
        for (int row = 0; row < 27; ++row) {
            // MATLAB: linear index = row + 27*col
            R[row][col] = V[row + 27 * col];
        }
    }
}

