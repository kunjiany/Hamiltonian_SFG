digraph SFGPipeline {
    rankdir=TB;   // Top-to-Bottom (vertical pipeline)
    node [
        shape=box
        style="rounded,filled"
        fillcolor="#e8f0ff"
        fontsize=20
        fontname="Helvetica"
    ];
    edge [
        penwidth=2
        color="#333333"
    ];

    PDB        [label="Protein Input (PDB)"];
    Geometry   [label="1. Geometry Extraction\nCO, CN, Local Frame"];
    LocalProp  [label="2. Local μ / α Construction"];
    Hamil      [label="3. Dipole–Dipole Hamiltonian"];
    Exciton    [label="4. Exciton Solve\nμ_ex, α_ex"];
    ChiMol     [label="5. χ² (molecular frame)\n27 components"];
    RotateChi  [label="6. Rotate χ² → χ²(lab)\nvia R3_ZXZ1 Database"];
    SFGBuild   [label="7. SFG Signal Build\nSSP (22) / PPP (26)\nLorentzian Sum"];
    Output     [label="8. Output Spectra\ncpp_sfg_ssp.txt\ncpp_sfg_ppp.txt"];

    PDB        -> Geometry;
    Geometry   -> LocalProp;
    LocalProp  -> Hamil;
    Hamil      -> Exciton;
    Exciton    -> ChiMol;
    ChiMol     -> RotateChi;
    RotateChi  -> SFGBuild;
    SFGBuild   -> Output;
}
